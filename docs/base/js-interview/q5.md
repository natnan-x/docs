<!--
 * @Author: NanNan
 * @Date: 2025-10-31 23:30:42
 * @LastEditTime: 2025-10-31 23:40:21
 * @Description:
-->

# AJAX、Fetch、Axios 的区别是什么

## 一、结论一句话

::: info AJAX 是概念，Fetch 是原生 API，Axios 是封装库。
三者核心区别在于底层实现、错误处理机制、功能封装、兼容性与易用性。
:::

## 二、详细对比

| 对比项           | AJAX（XMLHttpRequest）           | Fetch API                     | Axios                                |
| :--------------- | :------------------------------- | :---------------------------- | :----------------------------------- |
| **本质**         | 基于 XHR 的异步请求技术          | 原生 Promise 风格 HTTP API    | 第三方库（封装 XHR/Fetch）           |
| **语法风格**     | 回调（或需手动封装 Promise）     | Promise + async/await         | Promise + 拦截器封装                 |
| **错误处理**     | 手动判断状态码                   | 只在网络或 CORS 错误时抛异常  | 非 2xx 自动抛错                      |
| **JSON 处理**    | 手动 `JSON.parse()`              | `res.json()` 转换             | 自动解析 JSON                        |
| **请求取消**     | `xhr.abort()`                    | `AbortController`             | `AbortController` 或旧 `CancelToken` |
| **上传进度**     | 原生支持 `xhr.upload.onprogress` | 不支持（需流式实现）          | 支持 `onUploadProgress`              |
| **跨域携带凭证** | `xhr.withCredentials = true`     | `credentials: 'include'`      | `withCredentials: true`              |
| **拦截器机制**   | 无                               | 无                            | 支持请求与响应拦截器                 |
| **兼容性**       | 兼容旧浏览器                     | 现代浏览器支持（需 polyfill） | 兼容性强（依赖 XHR）                 |
| **Node 端支持**  | 否                               | Node 18+ 原生支持             | 是（axios 底层切换为 http 模块）     |

## 三、典型代码示例

### 1. AJAX (XHR)

```ts
const xhr = new XMLHttpRequest();
xhr.open('GET', '/api/user');
xhr.onload = () => {
  if (xhr.status === 200) {
    console.log(JSON.parse(xhr.responseText));
  }
};
xhr.send();
```

### 2. Fetch

```ts
fetch('/api/user')
  .then((res) => {
    if (!res.ok) throw new Error(`HTTP ${res.status}`);
    return res.json();
  })
  .then((data) => console.log(data))
  .catch((err) => console.error(err));
```

### 3. Axios

```ts
import axios from 'axios';

axios
  .get('/api/user')
  .then((res) => console.log(res.data))
  .catch((err) => console.error(err));
```

## 四、应用场景与优缺点

| 技术      | 优点                                       | 缺点                  | 适用场景                 |
| :-------- | :----------------------------------------- | :-------------------- | :----------------------- |
| **AJAX**  | 控制细粒度、支持进度事件、兼容性高         | 写法繁琐、无拦截器    | 老旧项目、上传文件       |
| **Fetch** | 语法简洁、原生支持 Promise、可用流式响应   | 无进度、非 2xx 不抛错 | 现代浏览器、轻量前端项目 |
| **Axios** | 功能完备、支持拦截器、自动 JSON、支持 Node | 需安装依赖、体积略大  | 现代项目通用标准方案     |

## 五、面试加分点

1. <b>Fetch 是 XHR 的现代替代方案</b>，语义更清晰，但功能仍未完全取代 XHR（缺乏上传进度事件）。
2. <b>Axios 封装了拦截器、超时、取消、并发控制</b>，统一了前后端 HTTP 请求体验。
3. <b>Axios 内部在浏览器端仍基于 XHR 实现</b>，在 Node 端使用 http 模块。
4. <b>Fetch 默认不抛出非 2xx 异常</b>，是很多面试官爱问的陷阱。
5. <b>请求取消统一标准是 AbortController</b>，Axios 新版和 Fetch 都已兼容。

## 六、面试口头速答模板（约 30 秒）

::: tip
“AJAX 是基于 XHR 的异步请求技术；Fetch 是浏览器原生提供的 Promise API，更现代但没有上传进度、非 2xx 不会抛错；Axios 是对 XHR 的高级封装，支持拦截器、超时、取消和自动 JSON 解析，兼容性和易用性都更好。现在项目中一般推荐用 Axios，Fetch 用于轻量或原生场景。”
:::
