<!--
 * @Author: NanNan
 * @Date: 2025-11-01 00:50:52
 * @LastEditTime: 2025-11-01 03:34:27
 * @Description:
-->

# map、filter、reduce 的使用场景

## 1. map() — 数据映射/转换

<b>概念：</b>数组遍历，返回一个 <b>新数组</b>，长度与原数组一致，每个元素是回调函数返回值。<br/>
<b>语法：</b>

```ts
arr.map((currentValue, index, array) => newValue);
```

<b>示例：</b>

```ts
interface User {
  id: number;
  firstName: string;
  lastName: string;
}

const users: User[] = [
  { id: 1, firstName: 'Nat', lastName: 'Nan' },
  { id: 2, firstName: 'John', lastName: 'Doe' },
];

const userNames = users.map((user) => ({
  id: user.id,
  fullName: `${user.firstName} ${user.lastName}`,
}));

console.log(userNames);
// [
//   { id: 1, fullName: 'Nat Nan' },
//   { id: 2, fullName: 'John Doe' }
// ]
```

<b>场景举例：</b>

- 前端渲染列表时，把接口返回的数据转换成组件需要的格式。
- 将数组的数字、对象字段统一格式化。

::: tip 特点
不修改原数组、返回新数组、适用于数组元素映射/转换
:::

## 2. filter() — 数据筛选/条件过滤

<b>概念：</b>遍历数组，根据回调函数返回的 布尔值 筛选元素，返回 新数组。<br/>
<b>语法：</b>

```ts
arr.filter((currentValue, index, array) => boolean);
```

<b>示例：</b>

```ts
const users = [
  { id: 1, name: 'Nat', online: true },
  { id: 2, name: 'John', online: false },
];

const onlineUsers = users.filter((u) => u.online);
console.log(onlineUsers);
// [{ id: 1, name: 'Nat', online: true }]
```

<b>场景举例：</b>

- 列表分页或搜索时，根据条件筛选数据。
- 筛选表单或接口返回的数据满足某些条件。

::: tip 特点
返回满足条件的元素组成的新数组、不修改原数组、适用于条件筛选，可与 map 链式操作完成复杂列表渲染
:::

## 3. reduce() — 聚合/统计/组合

<b>概念：</b>数组归约，把数组 归结为单个值（数字、对象、数组等）。<br/>
<b>语法：</b>

```ts
arr.reduce(
  (accumulator, currentValue, index, array) => newAccumulator,
  initialValue
);
```

<b>示例：计算购物车总价</b>

```ts
const cart = [
  { id: 1, name: 'Item1', price: 100, count: 2 },
  { id: 2, name: 'Item2', price: 200, count: 1 },
];

const total = cart.reduce((sum, item) => sum + item.price * item.count, 0);
console.log(total); // 400
```

<b>场景举例：</b>

- 计算总价、总分等累加值。
- 数据归类，如统计对象属性、按类型分类。
- 将接口返回的数组结构转成前端组件需要的对象或字典。

::: tip 特点

- reduce 功能最灵活，可一次完成 map + filter 的组合操作。
- 始值显式提供可避免空数组报错。
  :::

## 4. 实战组合

<b>场景：</b>获取在线用户名字的大写列表

#### 4.1 map()和 filter()组合写法

```ts
const users = [
  { name: 'Nat', online: true },
  { name: 'John', online: false },
  { name: 'Anna', online: true },
];

const result = users
  .filter((u) => u.online) // 筛选在线
  .map((u) => u.name.toUpperCase()); // 转大写

console.log(result); // ['NAT', 'ANNA']
```

#### 4.2 reduce 一次性完成

```ts
const result2 = users.reduce<string[]>((acc, u) => {
  if (u.online) acc.push(u.name.toUpperCase());
  return acc;
}, []);
```

::: tip 加分点

1. map/filter 不修改原数组，reduce 可归约成任意类型
2. reduce 可以替代 map + filter，实现链式操作
3. 初始值问题：reduce 如果不提供初始值，会以数组第一个元素作为 accumulator，空数组会报错
4. 性能：map/filter 每次返回新数组，多次链式操作会产生多次遍历；可用 reduce 一次完成多重操作
   :::

## 5. 口头答题模板（约 30 秒）

::: tip 30s 速答

1. map 用于数组映射，返回新数组，长度和原数组一致；
2. filter 用于筛选，返回满足条件的元素数组；
3. reduce 用于归约，将数组归结为单个值或对象，功能最灵活。
4. map/filter 不修改原数组，reduce 可以一次完成复杂转换或统计任务。”
   :::
