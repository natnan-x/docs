<!--
 * @Author: NanNan
 * @Date: 2025-11-01 01:20:58
 * @LastEditTime: 2025-11-01 01:33:39
 * @Description:
-->

# JavaScript 中 for...of 和 for...in 的区别？

## 一、写在前面

```ts
          ┌────────────┐
          │  for...in  │
          └────────────┘
               ↓
       遍历对象 → 键名(string)
       原型链属性也会遍历
       不适合数组

          ┌────────────┐
          │  for...of  │
          └────────────┘
               ↓
       遍历可迭代对象 → 值(value)
       支持 Array / Map / Set / String
       性能优于 for...in
```

::: tip 30s 速答

1. `for...in` 用于遍历对象的键名，包括原型链上的可枚举属性；
2. `for...of`用于遍历可迭代对象的值，比如数组、字符串、Map、Set。
3. 实际开发中，我们一般：
   - <b>遍历对象</b> → 用 `for...in` 或 `Object.keys()`；
   - <b>遍历数组/集合</b> → 用 `for...of`;
   - <b>因为 `for...of` 遍历的是值，性能更好，也不会受原型污染影响。</b>

:::

## 二、对比表

| 对比项           | `for...in`              | `for...of`                  |
| ---------------- | ----------------------- | --------------------------- |
| 遍历目标         | 对象（object）          | 可迭代对象（iterable）      |
| 遍历内容         | 键名（string）          | 值（value）                 |
| 可遍历数组       | ⚠️ 不推荐（键为字符串） | ✅ 推荐                     |
| 可遍历对象       | ✅ 支持                 | ❌ 不支持（需自定义迭代器） |
| 可遍历 Map / Set | ❌ 不支持               | ✅ 支持                     |
| 是否遍历原型链   | ✅ 是                   | ❌ 否                       |
| 是否遵循迭代协议 | ❌ 否                   | ✅ 是                       |
| 常见用途         | 遍历对象属性            | 遍历数组、Map、Set、字符串  |

## 三、实战示例对比

#### 1.遍历对象

```ts
const obj = { name: 'Nat', age: 35 };

for (const key in obj) {
  console.log(key, obj[key]);
}
// 输出: name Nat, age 35
```

⚠️ 注意：

```ts
Object.prototype.test = 'x';
for (const key in obj) console.log(key);
// 输出 name, age, test —— 原型属性也被遍历
```

👉 可加判断：

```ts
for (const key in obj) {
  if (obj.hasOwnProperty(key)) console.log(key);
}
```

#### 2. 遍历数组

```ts
const arr = [10, 20, 30];

// 推荐 for...of
for (const value of arr) console.log(value); // 10, 20, 30

// 不推荐 for...in
for (const index in arr) console.log(index); // '0', '1', '2'
```

#### 3. 遍历 Map / Set

```ts
const map = new Map([
  ['a', 1],
  ['b', 2],
]);
for (const [key, value] of map) console.log(key, value); // a 1, b 2

const set = new Set([1, 2, 3]);
for (const value of set) console.log(value); // 1, 2, 3
```

#### 4. for...of 遍历字符串

```ts
for (const ch of 'Nat') console.log(ch); // N a t
```

## 四、性能

<b>`for...of` 只遍历自身可迭代项，性能更好。</b><br/>
<b>`for...in` 会额外检查原型链，性能稍差。</b>
