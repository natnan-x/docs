# Vue 单向与双向数据流

**定义：**
Vue 中的数据流主要分为两种：**单向数据流（One-way Data Flow）** 与 **双向数据绑定（Two-way Data Binding）**。理解两者的区别有助于掌握数据传递、状态管理及组件通信。

## 一、单向数据流

### 1. 含义

数据从父组件通过 `props` 向下传递到子组件，子组件 **不能直接修改** 父组件的数据，只能通过事件或回调通知父组件修改。此机制称为单向数据流。

### 2. 特点

- 数据流向清晰：父 → 子。
- 子组件数据变化不影响父组件，除非显式触发事件。
- 便于调试、维护。

### 3. 示例

```typescript
<!-- Parent.vue -->
<template>
  <Child :count="num" @update="handleUpdate" />
</template>

<script setup lang="ts">
import { ref } from 'vue';
import Child from './Child.vue';

const num = ref(0);
const handleUpdate = (val: number) => {
  num.value = val;
};
</script>

<!-- Child.vue -->
<template>
  <button @click="add">子组件加1</button>
</template>

<script setup lang="ts">
const props = defineProps<{ count: number }>();
const emit = defineEmits(['update']);

const add = () => {
  emit('update', props.count + 1);
};
</script>
```

**说明：**
父组件通过 `props` 将数据传递给子组件，子组件通过事件 `emit` 通知父组件更新，形成单向数据流。

## 二、双向数据流

### 1. 含义

双向数据流指组件内 **数据变化自动反映到视图上**，同时 **视图变化也会更新数据**。

在 Vue 中通过 `v-model` 实现。

### 2. 特点

- 数据与视图保持同步。
- 开发效率高，但在复杂项目中数据流向不够清晰。

### 3. 示例

```typescript
<template>
  <input v-model="username" placeholder="输入用户名">
  <p>用户名：{{ username }}</p>
</template>

<script setup lang="ts">
import { ref } from 'vue';
const username = ref('');
</script>
```

**说明：**
`v-model` 相当于绑定 `:value` 和监听 `@input` 事件：

```html
<input :value="username" @input="username = $event.target.value" />
```

### 4. 自定义组件的双向绑定

```typescript
<!-- Parent.vue -->
<template>
  <Child v-model="msg" />
</template>

<script setup lang="ts">
import { ref } from 'vue';
import Child from './Child.vue';

const msg = ref('Hello');
</script>

<!-- Child.vue -->
<template>
  <input :value="modelValue" @input="emit('update:modelValue', $event.target.value)">
</template>

<script setup lang="ts">
const props = defineProps<{ modelValue: string }>();
const emit = defineEmits(['update:modelValue']);
</script>
```

## 三、核心区别

| 对比项   | 单向数据流                   | 双向数据流               |
| -------- | ---------------------------- | ------------------------ |
| 数据流向 | 父 → 子                      | 父 ↔ 子                  |
| 修改方式 | 子组件需通过事件通知父组件   | 子组件可直接修改绑定数据 |
| 适用场景 | 状态可控、逻辑清晰的组件通信 | 表单输入、简单交互       |
| 优点     | 调试方便、可维护性高         | 开发快速、代码简洁       |
| 缺点     | 需要显式事件通信             | 数据流复杂时难以追踪     |

---

## 四、总结（面试高频一句话）

> Vue 遵循单向数据流原则：父传子 props，子通过事件更新父。双向数据绑定是通过 `v-model` 实现的数据与视图同步机制，常用于表单控件和简易交互场景。
