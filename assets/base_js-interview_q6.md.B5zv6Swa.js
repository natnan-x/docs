import{_ as i,c as t,o as a,af as l}from"./chunks/framework.hx-odK46.js";const E=JSON.parse('{"title":"JavaScript 脚本延迟加载方式有哪些？有什么区别？","description":"","frontmatter":{},"headers":[],"relativePath":"base/js-interview/q6.md","filePath":"base/js-interview/q6.md"}'),e={name:"base/js-interview/q6.md"};function h(n,s,k,p,d,r){return a(),t("div",null,[...s[0]||(s[0]=[l(`<h1 id="javascript-脚本延迟加载方式有哪些-有什么区别" tabindex="-1">JavaScript 脚本延迟加载方式有哪些？有什么区别？ <a class="header-anchor" href="#javascript-脚本延迟加载方式有哪些-有什么区别" aria-label="Permalink to “JavaScript 脚本延迟加载方式有哪些？有什么区别？”">​</a></h1><h2 id="一、核心结论" tabindex="-1">一、核心结论 <a class="header-anchor" href="#一、核心结论" aria-label="Permalink to “一、核心结论”">​</a></h2><div class="info custom-block"><p class="custom-block-title">JavaScript 延迟加载常见方式有：</p><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">&lt;!-- 方法1 --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">&lt;!-- 方法2 --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">&lt;!-- 方法3: 动态创建&lt;script&gt;&lt;/script&gt; --&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">&lt;!-- 方法4: type=&quot;module&quot; --&gt;</span></span></code></pre></div><p>区别主要体现在 执行时机、加载顺序 和 依赖处理。</p></div><h2 id="二、方式与区别详解" tabindex="-1">二、方式与区别详解 <a class="header-anchor" href="#二、方式与区别详解" aria-label="Permalink to “二、方式与区别详解”">​</a></h2><table tabindex="0"><thead><tr><th style="text-align:left;">方式</th><th style="text-align:left;">加载行为</th><th style="text-align:left;">执行时机</th><th style="text-align:left;">是否按顺序执行</th><th style="text-align:left;">典型场景</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>普通 script</strong></td><td style="text-align:left;">阻塞 HTML 解析</td><td style="text-align:left;">加载完成后立即执行</td><td style="text-align:left;">✅ 按顺序</td><td style="text-align:left;">旧式同步脚本</td></tr><tr><td style="text-align:left;"><strong>defer</strong></td><td style="text-align:left;">异步加载（并行下载）</td><td style="text-align:left;">DOM 构建完成后执行（<code>DOMContentLoaded</code> 前）</td><td style="text-align:left;">✅ 保证顺序</td><td style="text-align:left;">多脚本依赖、页面初始化脚本</td></tr><tr><td style="text-align:left;"><strong>async</strong></td><td style="text-align:left;">异步加载</td><td style="text-align:left;">下载完立刻执行，<strong>不等待 DOM</strong></td><td style="text-align:left;">❌ 无顺序</td><td style="text-align:left;">独立脚本（广告、统计）</td></tr><tr><td style="text-align:left;"><strong>动态创建 script</strong></td><td style="text-align:left;">JS 运行时插入</td><td style="text-align:left;">加载完立即执行（默认 async）</td><td style="text-align:left;">❌ 无顺序</td><td style="text-align:left;">条件加载、懒加载</td></tr><tr><td style="text-align:left;"><strong>type=&quot;module&quot;</strong></td><td style="text-align:left;">异步加载模块文件</td><td style="text-align:left;">模块依赖解析完后执行</td><td style="text-align:left;">✅ 模块依赖自动管理</td><td style="text-align:left;">ES Module 项目（Vite、Vue3）</td></tr></tbody></table><h2 id="三、详细示例" tabindex="-1">三、详细示例 <a class="header-anchor" href="#三、详细示例" aria-label="Permalink to “三、详细示例”">​</a></h2><h4 id="_1-普通加载-阻塞" tabindex="-1">1. 普通加载（阻塞） <a class="header-anchor" href="#_1-普通加载-阻塞" aria-label="Permalink to “1. 普通加载（阻塞）”">​</a></h4><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> src</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;main.js&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p><b>浏览器会暂停 HTML 解析，直到脚本加载并执行完毕。</b></p><h4 id="_2-defer" tabindex="-1">2. defer <a class="header-anchor" href="#_2-defer" aria-label="Permalink to “2. defer”">​</a></h4><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> src</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;app.js&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> src</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;util.js&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><ul><li>并行下载，不阻塞 DOM。</li><li>DOM 解析完成后、DOMContentLoaded 前按顺序执行。</li><li>常用于主逻辑脚本或依赖 DOM 的代码。</li></ul><h4 id="_3-async" tabindex="-1">3. async <a class="header-anchor" href="#_3-async" aria-label="Permalink to “3. async”">​</a></h4><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> src</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ads.js&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> src</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;analytics.js&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><ul><li>并行下载，不阻塞 DOM。</li><li>哪个脚本先加载完就先执行，不保证顺序。</li><li>用于独立脚本（广告统计类，不依赖其他文件）。</li></ul><h4 id="_4-动态加载" tabindex="-1">4. 动态加载 <a class="header-anchor" href="#_4-动态加载" aria-label="Permalink to “4. 动态加载”">​</a></h4><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> script</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> document.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createElement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;script&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">script.src </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;/lazy.js&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">script.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">onload</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;加载完成&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">document.body.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">appendChild</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(script);</span></span></code></pre></div><ul><li>默认异步加载，加载完立即执行。</li><li>可配合事件或条件（如用户操作）加载。</li></ul><h4 id="_5-模块脚本" tabindex="-1">5. 模块脚本 <a class="header-anchor" href="#_5-模块脚本" aria-label="Permalink to “5. 模块脚本”">​</a></h4><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;module&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> src</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;main.js&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><ul><li>自动延迟执行，等所有依赖加载完成后再执行。</li><li>相当于内置 defer 行为。</li><li>模块间依赖按 import 顺序保证。</li></ul><h2 id="四、面试高频加分点" tabindex="-1">四、面试高频加分点 <a class="header-anchor" href="#四、面试高频加分点" aria-label="Permalink to “四、面试高频加分点”">​</a></h2><ol><li><code>defer</code> 与 <code>async</code> 区别</li></ol><ul><li><code>defer</code> 保证顺序、在 DOM 解析后执行；</li><li><code>async</code> 不保证顺序、加载完立刻执行。</li></ul><ol start="2"><li><b>模块脚本默认是 <code>defer</code> 行为</b>（但不能与 <code>defer</code> 一起用）。</li><li><b>动态加载 <code>script</code> 的 <code>asyn</code>c 属性可手动设为 <code>false</code> 以强制顺序执行</b>：</li></ol><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> s</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> document.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createElement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;script&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s.async </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s.src </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;/file.js&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">document.head.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">appendChild</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(s);</span></span></code></pre></div><ol start="4"><li>性能优化策略：</li></ol><ul><li>首屏关键 JS 不应使用 <code>async</code>；</li><li>辅助类、第三方脚本适合 <code>async</code>；</li><li>应用主逻辑建议使用 <code>defer</code>；</li><li>模块化项目自动处理，无需手动设置。</li></ul><h2 id="五、口头答题模板-约-30-秒" tabindex="-1">五、口头答题模板（约 30 秒） <a class="header-anchor" href="#五、口头答题模板-约-30-秒" aria-label="Permalink to “五、口头答题模板（约 30 秒）”">​</a></h2><div class="tip custom-block"><p class="custom-block-title custom-block-title-default">TIP</p><p>“JS 延迟加载主要有四种方式：<code>defer</code>、<code>async</code>、动态创建 <code>script</code> 以及 <code>ES module</code>。<code>defer</code> 会并行加载，在 DOM 解析完后按顺序执行；<code>async</code> 会并行加载，哪个先完成先执行，不保证顺序；动态创建 <code>script</code> 默认异步，可按需加载；而模块脚本默认具有 <code>defer</code> 行为。实际开发中页面主逻辑脚本用 <code>defer</code>，独立脚本用 <code>async</code>，懒加载用动态创建。”</p></div>`,30)])])}const c=i(e,[["render",h]]);export{E as __pageData,c as default};
